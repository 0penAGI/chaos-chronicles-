—â–∞<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="telegram-web-app" content="true">
    <title>üí• $XSDC QUANTUM CHAOS üí•</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
            touch-action: manipulation;
        }

        body {
            font-family: 'Impact', 'Arial Black', sans-serif;
            background: #000;
            color: #FFF;
            overflow: hidden;
            height: 100vh;
            position: relative;
            overscroll-behavior: none;
        }
        
        /* –ñ–ò–í–û–ô –ö–í–ê–ù–¢–û–í–´–ô –§–û–ù */
        #quantum-bg {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: radial-gradient(circle at var(--mouse-x, 50%) var(--mouse-y, 50%), 
                #FF0000, #FF6B00, #FFD700, #00FF00, #00FFFF, #0000FF, #FF00FF, #FF0000);
            background-size: 400% 400%;
            animation: quantumPulse 3s infinite;
            opacity: 0.3;
            z-index: 0;
            transition: opacity 0.3s, filter 0.3s;
        }
        
        @keyframes quantumPulse {
            0%, 100% { 
                background-position: 0% 50%; 
                filter: hue-rotate(0deg) brightness(1);
            }
            25% { 
                background-position: 50% 100%; 
                filter: hue-rotate(90deg) brightness(1.2);
            }
            50% { 
                background-position: 100% 50%; 
                filter: hue-rotate(180deg) brightness(1.5);
            }
            75% { 
                background-position: 50% 0%; 
                filter: hue-rotate(270deg) brightness(1.2);
            }
        }
        
        /* –í–†–ï–ú–ï–ù–ù–´–ï –†–Ø–ë–¨ */
        .time-ripple {
            position: fixed;
            border: 2px solid rgba(0, 255, 255, 0.5);
            border-radius: 50%;
            pointer-events: none;
            animation: rippleExpand 2s forwards;
            z-index: 1;
        }
        
        @keyframes rippleExpand {
            0% { width: 0; height: 0; opacity: 1; }
            100% { width: 300px; height: 300px; opacity: 0; }
        }
        
        #game {
            position: relative;
            z-index: 2;
            height: 100vh;
            display: flex;
            flex-direction: column;
            /* –î–æ–±–∞–≤–ª—è–µ–º 55px —Ç–æ–ª—å–∫–æ —Å–≤–µ—Ä—Ö—É, –æ—Å—Ç–∞–ª—å–Ω—ã–µ –æ—Ç—Å—Ç—É–ø—ã 10px –∫–∞–∫ –±—ã–ª–æ */
            padding-top: 66px; 
            padding-left: 10px;
            padding-right: 10px;
            padding-bottom: 10px;
            /* –ò–ª–∏ –∫–æ—Ä–æ—á–µ: padding: 65px 10px 10px 10px; */
            justify-content: space-between;
        }


        
        /* –°–ß–ï–¢–ß–ò–ö –° –ü–£–õ–¨–°–ê–¶–ò–ï–ô */
        #xsdc-counter {
            text-align: center;
            padding: 15px;
            background: rgba(0, 0, 0, 0.9);
            border-radius: 20px;
            border: 4px solid #FFD700;
            box-shadow: 0 0 30px var(--glow-color, #FFD700);
            animation: counterPulse 1s infinite;
            position: relative;
            overflow: hidden;
        }
        
        #xsdc-counter::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: linear-gradient(45deg, transparent, rgba(255, 215, 0, 0.1), transparent);
            animation: shine 3s infinite;
        }
        
        @keyframes shine {
            0% { transform: translateX(-100%) translateY(-100%) rotate(45deg); }
            100% { transform: translateX(100%) translateY(100%) rotate(45deg); }
        }
        
        @keyframes counterPulse {
            0%, 100% { 
                transform: scale(1); 
                box-shadow: 0 0 30px var(--glow-color, #FFD700);
            }
            50% { 
                transform: scale(1.03); 
                box-shadow: 0 0 50px var(--glow-color, #FFD700), 0 0 80px var(--glow-color, #FF6B00);
            }
        }
        
        #xsdc-amount {
            font-size: 42px;
            font-weight: bold;
            color: #FFD700;
            text-shadow: 0 0 20px #FFD700, 0 0 40px #FF6B00;
            letter-spacing: 2px;
            position: relative;
            z-index: 1;
        }
        
        #xsdc-label {
            font-size: 18px;
            color: #FFF;
            margin-top: 5px;
            text-shadow: 0 0 10px #00FFFF;
            position: relative;
            z-index: 1;
        }
        
        /* –°–¢–ê–¢–ò–°–¢–ò–ö–ê */
        #stats {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 8px;
            margin: 10px 0;
        }
        
        .stat {
            background: rgba(0, 0, 0, 0.85);
            padding: 10px;
            border-radius: 12px;
            border: 2px solid;
            text-align: center;
            font-size: 13px;
            font-weight: bold;
            transition: all 0.3s;
        }
        
        .stat-value {
            font-size: 20px;
            margin-top: 5px;
        }
        
        #combo { border-color: #FF00FF; color: #FF00FF; }
        #multiplier { border-color: #00FF00; color: #00FF00; }
        #speed { border-color: #00FFFF; color: #00FFFF; }
        
        /* –ò–ì–†–û–í–û–ï –ü–û–õ–ï */
        #field {
            flex: 1;
            position: relative;
            background: rgba(0, 0, 0, 0.6);
            border: 3px solid #FF6B00;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: inset 0 0 50px rgba(255, 107, 0, 0.5);
            touch-action: none;
        }
        
        /* –ö–í–ê–ù–¢–û–í–´–ï –¶–ï–õ–ò */
        .target {
            position: absolute;
            width: 70px;
            height: 70px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 32px;
            font-weight: bold;
            cursor: pointer;
            user-select: none;
            transition: transform 0.1s, filter 0.3s;
            will-change: transform;
        }
        
        .target:active {
            transform: scale(0.7) !important;
        }
        
        /* –û–±—ã—á–Ω–∞—è —Ü–µ–ª—å */
        .target-xsdc {
            background: radial-gradient(circle, #FFD700, #FF6B00);
            border: 3px solid #FFF;
            box-shadow: 0 0 25px #FFD700;
            animation: targetFloat 2s infinite ease-in-out;
        }
        
        @keyframes targetFloat {
            0%, 100% { transform: translateY(0) rotate(0deg) scale(1); }
            50% { transform: translateY(-15px) rotate(180deg) scale(1.05); }
        }
        
        /* –ú–ï–ì–ê —Ü–µ–ª—å */
        .target-mega {
            background: radial-gradient(circle, #FF00FF, #00FFFF);
            border: 4px solid #FFF;
            box-shadow: 0 0 40px #FF00FF;
            animation: megaPulse 0.4s infinite, targetSpin 3s infinite linear;
        }
        
        @keyframes megaPulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.15); }
        }
        
        @keyframes targetSpin {
            0% { filter: hue-rotate(0deg); }
            100% { filter: hue-rotate(360deg); }
        }
        
        /* –ë–û–ú–ë–ê - —É–±–µ–≥–∞–µ—Ç */
        .target-bomb {
            background: radial-gradient(circle, #FF0000, #000);
            border: 4px solid #FF0000;
            box-shadow: 0 0 30px #FF0000;
            animation: bombShake 0.2s infinite;
        }
        
        @keyframes bombShake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-3px) rotate(-5deg); }
            75% { transform: translateX(3px) rotate(5deg); }
        }
        
        /* –ö–í–ê–ù–¢–û–í–ê–Ø —Ü–µ–ª—å - –¥—É–±–ª–∏—Ä—É–µ—Ç—Å—è */
        .target-quantum {
            background: radial-gradient(circle, #9D00FF, #00FFFF, #FFD700);
            border: 4px solid #FFF;
            box-shadow: 0 0 50px #9D00FF;
            animation: quantumShift 1s infinite;
            filter: blur(1px);
        }
        
        @keyframes quantumShift {
            0%, 100% { opacity: 1; transform: scale(1); }
            50% { opacity: 0.7; transform: scale(1.1) translateX(5px); }
        }
        
        /* –ü–†–ò–ó–†–ê–ö —Ü–µ–ª–∏ */
        .target-ghost {
            opacity: 0.6;
            pointer-events: none;
            animation: ghostFade 1s forwards;
        }
        
        @keyframes ghostFade {
            0% { opacity: 0.6; }
            100% { opacity: 0; }
        }
        
        /* –í–ó–†–´–í–´ */
        .explosion {
            position: fixed;
            pointer-events: none;
            font-size: 50px;
            font-weight: bold;
            animation: explode 0.8s forwards;
            z-index: 100;
        }
        
        @keyframes explode {
            0% { 
                transform: scale(0) rotate(0deg); 
                opacity: 1; 
                filter: blur(0);
            }
            50% { 
                transform: scale(1.5) rotate(180deg); 
                opacity: 1;
                filter: blur(2px);
            }
            100% { 
                transform: scale(2.5) rotate(360deg); 
                opacity: 0;
                filter: blur(5px);
            }
        }
        
        /* –ß–ê–°–¢–ò–¶–´ */
        .particle {
            position: fixed;
            width: 6px;
            height: 6px;
            border-radius: 50%;
            pointer-events: none;
            animation: particleFly 1s forwards;
            box-shadow: 0 0 5px currentColor;
        }
        
        @keyframes particleFly {
            0% { transform: translate(0, 0) scale(1); opacity: 1; }
            100% { 
                transform: translate(var(--tx), var(--ty)) scale(0) rotate(720deg); 
                opacity: 0; 
            }
        }
        
        /* –ë–£–°–¢–ï–†–´ */
        #boosters {
            display: flex;
            justify-content: space-around;
            gap: 8px;
            padding: 8px 0;
        }
        
        .booster {
            flex: 1;
            padding: 12px;
            background: rgba(0, 0, 0, 0.9);
            border: 3px solid;
            border-radius: 15px;
            font-size: 26px;
            cursor: pointer;
            transition: all 0.2s;
            position: relative;
            text-align: center;
            min-height: 60px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .booster:active:not(.disabled) {
            transform: scale(0.9);
        }
        
        .booster.disabled {
            opacity: 0.3;
            cursor: not-allowed;
        }
        
        #boost-x2 { border-color: #00FF00; }
        #boost-frenzy { border-color: #FF00FF; }
        #boost-magnet { border-color: #00FFFF; }
        #boost-quantum { border-color: #9D00FF; }
        
        .booster-count {
            position: absolute;
            top: -8px;
            right: -8px;
            background: #FF0000;
            color: #FFF;
            width: 24px;
            height: 24px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 14px;
            font-weight: bold;
            border: 2px solid #000;
        }
        
        /* –ê–ö–¢–ò–í–ù–´–ï –≠–§–§–ï–ö–¢–´ */
        #active-effects {
            position: fixed;
            top: 10px;
            right: 10px;
            display: flex;
            flex-direction: column;
            gap: 5px;
            z-index: 10;
        }
        
        .effect-badge {
            background: rgba(0, 0, 0, 0.9);
            padding: 6px 12px;
            border-radius: 20px;
            border: 2px solid;
            font-size: 13px;
            font-weight: bold;
            animation: badgePulse 0.5s infinite;
        }
        
        @keyframes badgePulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }
        
        /* –£–í–ï–î–û–ú–õ–ï–ù–ò–Ø */
        #notification {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) scale(0);
            background: rgba(0, 0, 0, 0.95);
            padding: 25px 40px;
            border-radius: 20px;
            border: 4px solid #FFD700;
            font-size: 28px;
            font-weight: bold;
            text-align: center;
            z-index: 1000;
            box-shadow: 0 0 50px #FFD700;
            pointer-events: none;
            max-width: 80%;
        }
        
        .show-notification {
            animation: showNotif 1s forwards;
        }
        
        @keyframes showNotif {
            0% { transform: translate(-50%, -50%) scale(0) rotate(-180deg); }
            50% { transform: translate(-50%, -50%) scale(1.15) rotate(10deg); }
            100% { transform: translate(-50%, -50%) scale(1) rotate(0deg); }
        }
        
        /* –°–õ–ï–î –û–¢ –ü–ê–õ–¨–¶–ê */
        .finger-trail {
            position: fixed;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: radial-gradient(circle, rgba(255, 215, 0, 0.8), transparent);
            pointer-events: none;
            animation: trailFade 0.5s forwards;
            z-index: 999;
        }
        
        @keyframes trailFade {
            0% { transform: scale(1); opacity: 1; }
            100% { transform: scale(2); opacity: 0; }
        }
        
        /* –ü–ê–£–ó–ê –ò –ú–ï–ù–Æ */
        #pause-menu {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            display: none;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 2000;
            gap: 20px;
        }
        
        #pause-menu.show {
            display: flex;
        }
        
        .menu-button {
            background: rgba(0, 0, 0, 0.9);
            border: 3px solid #FFD700;
            border-radius: 15px;
            padding: 15px 30px;
            font-size: 24px;
            color: #FFD700;
            cursor: pointer;
            transition: all 0.2s;
            text-align: center;
            min-width: 200px;
        }
        
        .menu-button:active {
            transform: scale(0.95);
        }
        
        #pause-button {
            position: fixed;
            top: 77px;
            left: 10px;
            background: rgba(0, 0, 0, 0.8);
            border: 2px solid #FFD700;
            border-radius: 10px;
            padding: 8px 15px;
            color: #FFD700;
            font-size: 16px;
            cursor: pointer;
            z-index: 100;
        }
        
        @media (max-width: 400px) {
            #xsdc-amount { font-size: 36px; }
            #xsdc-label { font-size: 16px; }
            .target { width: 60px; height: 60px; font-size: 28px; }
            .booster { font-size: 22px; padding: 10px; min-height: 55px; }
            #notification { font-size: 22px; padding: 20px 30px; }
            .stat { font-size: 12px; padding: 8px; }
            .stat-value { font-size: 18px; }
            .menu-button { font-size: 20px; padding: 12px 25px; min-width: 180px; }
        }
    </style>
</head>
<body>
    <div id="quantum-bg"></div>

    <div id="game">
        <button id="pause-button">‚è∏Ô∏è</button>
        
        <div id="xsdc-counter">
            <div id="xsdc-amount">0</div>
            <div id="xsdc-label">$XSDC QUANTUM üíé</div>
        </div>
        
        <div id="stats">
            <div id="combo" class="stat">
                ‚ö° COMBO
                <div class="stat-value" id="combo-value">x1</div>
            </div>
            <div id="multiplier" class="stat">
                üî• XXX
                <div class="stat-value" id="mult-value">x1</div>
            </div>
            <div id="speed" class="stat">
                üí® RESONANCE
                <div class="stat-value" id="speed-value">1.0</div>
            </div>
        </div>
        
        <div id="field"></div>
        
        <div id="boosters">
            <div class="booster" id="boost-x2">
                2Ô∏è‚É£‚úñÔ∏è
                <div class="booster-count">3</div>
            </div>
            <div class="booster" id="boost-frenzy">
                üå™Ô∏è
                <div class="booster-count">2</div>
            </div>
            <div class="booster" id="boost-magnet">
                üß≤
                <div class="booster-count">2</div>
            </div>
            <div class="booster" id="boost-quantum">
                üåÄ
                <div class="booster-count">1</div>
            </div>
        </div>
    </div>

    <div id="pause-menu">
        <div class="menu-button" id="resume-button">RESUME</div>
        <div class="menu-button" id="restart-button">RESTART</div>
        <div class="menu-button" id="help-button">HELP</div>
    </div>

    <div id="active-effects"></div>
    <div id="notification"></div>

    <script>
        // TELEGRAM WEB APP
        const tg = window.Telegram?.WebApp;
        if (tg) {
            tg.ready();
            tg.expand();
            tg.enableClosingConfirmation();
            tg.setHeaderColor('#000000');
            tg.setBackgroundColor('#000000');
        }
        
        // –ü–ï–†–ï–ú–ï–ù–ù–´–ï
        let xsdc = 0;
        let combo = 0;
        let multiplier = 1;
        let spawnSpeed = 1.0;
        let activeTargets = [];
        let timeRipples = [];
        let emotionalIntensity = 0;
        let isPaused = false;
        let gameStarted = false;
        
        // –ë–£–°–¢–ï–†–´
        let boosters = {
            x2: { count: 3, active: false, duration: 0 },
            frenzy: { count: 2, active: false, duration: 0 },
            magnet: { count: 2, active: false, duration: 0 },
            quantum: { count: 1, active: false, duration: 0 }
        };
        
        // –≠–õ–ï–ú–ï–ù–¢–´
        const field = document.getElementById('field');
        const xsdcAmount = document.getElementById('xsdc-amount');
        const comboValue = document.getElementById('combo-value');
        const multValue = document.getElementById('mult-value');
        const speedValue = document.getElementById('speed-value');
        const notification = document.getElementById('notification');
        const activeEffects = document.getElementById('active-effects');
        const quantumBg = document.getElementById('quantum-bg');
        const xsdcCounter = document.getElementById('xsdc-counter');
        const pauseMenu = document.getElementById('pause-menu');
        const pauseButton = document.getElementById('pause-button');
        const resumeButton = document.getElementById('resume-button');
        const restartButton = document.getElementById('restart-button');
        const helpButton = document.getElementById('help-button');
        
        // –û–ë–ù–û–í–õ–ï–ù–ò–ï $XSDC
        function updateXSDC(amount) {
            if (isPaused) return 0;
            
            const bonus = multiplier * (boosters.x2.active ? 2 : 1);
            const finalAmount = Math.floor(amount * bonus);
            xsdc += finalAmount;
            xsdcAmount.textContent = Math.floor(xsdc);
            
            // –ê–Ω–∏–º–∞—Ü–∏—è —Å—á–µ—Ç—á–∏–∫–∞
            xsdcAmount.style.animation = 'none';
            setTimeout(() => xsdcAmount.style.animation = '', 10);
            
            // –í–∏–±—Ä–∞—Ü–∏—è —á–µ—Ä–µ–∑ Telegram
            if (tg && finalAmount > 0) {
                tg.HapticFeedback.impactOccurred('light');
            }
            
            return finalAmount;
        }
        
        // –û–ë–ù–û–í–õ–ï–ù–ò–ï –ö–û–ú–ë–û
        function updateCombo() {
            if (isPaused) return;
            
            combo++;
            emotionalIntensity = Math.min(1, combo * 0.05);
            
            // –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º –º–Ω–æ–∂–∏—Ç–µ–ª—å
            if (combo % 5 === 0) {
                multiplier = Math.min(15, multiplier + 1);
                multValue.textContent = 'x' + multiplier;
                showNotification(`üî• x${multiplier} FIRE!`);
                
                if (tg) tg.HapticFeedback.notificationOccurred('success');
            }
            
            comboValue.textContent = 'x' + combo;
            
            // –£—Å–∫–æ—Ä–µ–Ω–∏–µ
            spawnSpeed = Math.min(3.5, 1 + combo * 0.06);
            speedValue.textContent = spawnSpeed.toFixed(1);
            
            // –†–µ–∞–∫—Ü–∏—è —Ñ–æ–Ω–∞
            updateBackgroundResonance();
        }
        
        // –°–ë–†–û–° –ö–û–ú–ë–û
        function resetCombo() {
            if (isPaused) return;
            
            if (combo > 10) {
                showNotification('üíî LOST CONNECTION');
                if (tg) tg.HapticFeedback.notificationOccurred('error');
            }
            combo = 0;
            multiplier = 1;
            emotionalIntensity = 0;
            comboValue.textContent = 'x1';
            multValue.textContent = 'x1';
            updateBackgroundResonance();
        }
        
        // –†–ï–ó–û–ù–ê–ù–° –§–û–ù–ê
        function updateBackgroundResonance() {
            const speed = Math.max(0.5, 3 - emotionalIntensity * 2.5);
            const opacity = 0.3 + emotionalIntensity * 0.5;
            quantumBg.style.animationDuration = speed + 's';
            quantumBg.style.opacity = opacity;
            
            // –¶–≤–µ—Ç —Å–≤–µ—á–µ–Ω–∏—è —Å—á–µ—Ç—á–∏–∫–∞
            const hue = emotionalIntensity * 360;
            xsdcCounter.style.setProperty('--glow-color', `hsl(${hue}, 100%, 50%)`);
        }
        
        // –í–†–ï–ú–ï–ù–ù–ê–Ø –†–Ø–ë–¨
        function createTimeRipple(x, y) {
            if (isPaused) return;
            
            const ripple = document.createElement('div');
            ripple.className = 'time-ripple';
            ripple.style.left = (x - 150) + 'px';
            ripple.style.top = (y - 150) + 'px';
            document.body.appendChild(ripple);
            
            const rippleData = {
                x, y,
                born: Date.now(),
                resonance: combo * multiplier,
                element: ripple
            };
            timeRipples.push(rippleData);
            
            setTimeout(() => {
                ripple.remove();
                timeRipples = timeRipples.filter(r => r !== rippleData);
            }, 2000);
        }
        
        // –°–õ–ï–î –û–¢ –ö–ê–°–ê–ù–ò–Ø
        function createFingerTrail(x, y) {
            if (isPaused) return;
            
            const trail = document.createElement('div');
            trail.className = 'finger-trail';
            trail.style.left = (x - 10) + 'px';
            trail.style.top = (y - 10) + 'px';
            document.body.appendChild(trail);
            
            setTimeout(() => trail.remove(), 500);
        }
        
        // –°–ü–ê–í–ù –¶–ï–õ–ò
        function spawnTarget() {
            if (isPaused || !gameStarted) return;
            
            const target = document.createElement('div');
            target.className = 'target';
            
            // –¢–∏–ø—ã —Ü–µ–ª–µ–π
            const rand = Math.random();
            let type, value, emoji;
            
            if (rand < 0.55) {
                type = 'xsdc';
                value = 10;
                emoji = 'üíé';
                target.classList.add('target-xsdc');
            } else if (rand < 0.75) {
                type = 'mega';
                value = 50;
                emoji = 'üí•';
                target.classList.add('target-mega');
            } else if (rand < 0.90) {
                type = 'bomb';
                value = 100;
                emoji = 'üí£';
                target.classList.add('target-bomb');
            } else {
                type = 'quantum';
                value = 25;
                emoji = 'üåÄ';
                target.classList.add('target-quantum');
            }
            
            target.innerHTML = emoji;
            target.dataset.type = type;
            target.dataset.value = value;
            target.dataset.born = Date.now();
            
            // –ü–æ–∑–∏—Ü–∏—è
            const fieldRect = field.getBoundingClientRect();
            const maxX = fieldRect.width - 70;
            const maxY = fieldRect.height - 70;
            
            let x = Math.random() * maxX;
            let y = Math.random() * maxY;
            
            // –ò–∑–±–µ–≥–∞–µ–º –¥—Ä—É–≥–∏—Ö —Ü–µ–ª–µ–π
            for (const other of activeTargets) {
                const ox = parseFloat(other.style.left);
                const oy = parseFloat(other.style.top);
                const dist = Math.sqrt((x - ox) ** 2 + (y - oy) ** 2);
                if (dist < 80) {
                    x = Math.random() * maxX;
                    y = Math.random() * maxY;
                }
            }
            
            target.style.left = x + 'px';
            target.style.top = y + 'px';
            
            // –≠–ú–ü–ê–¢–ò–Ø - —Ü–µ–ª–∏ —á—É–≤—Å—Ç–≤—É—é—Ç –∏–≥—Ä–æ–∫–∞
            if (emotionalIntensity > 0.5 && type === 'bomb') {
                // –ë–æ–º–±—ã –ø—ã—Ç–∞—é—Ç—Å—è —É–±–µ–∂–∞—Ç—å
                const escapeInterval = setInterval(() => {
                    if (!target.parentNode || isPaused) {
                        clearInterval(escapeInterval);
                        return;
                    }
                    
                    const currentX = parseFloat(target.style.left);
                    const currentY = parseFloat(target.style.top);
                    
                    // –£–±–µ–≥–∞–µ–º –æ—Ç —Ü–µ–Ω—Ç—Ä–∞
                    const centerX = fieldRect.width / 2;
                    const centerY = fieldRect.height / 2;
                    const dx = currentX - centerX;
                    const dy = currentY - centerY;
                    const angle = Math.atan2(dy, dx);
                    
                    const newX = Math.max(0, Math.min(maxX, currentX + Math.cos(angle) * 3));
                    const newY = Math.max(0, Math.min(maxY, currentY + Math.sin(angle) * 3));
                    
                    target.style.left = newX + 'px';
                    target.style.top = newY + 'px';
                }, 100);
            }
            
            // –ö–ª–∏–∫
            target.addEventListener('click', () => handleTargetClick(target));
            
            field.appendChild(target);
            activeTargets.push(target);
            
            // –ê–≤—Ç–æ—É–¥–∞–ª–µ–Ω–∏–µ
            const lifetime = Math.max(2000, 4000 / spawnSpeed);
            setTimeout(() => {
                if (target.parentNode && !boosters.magnet.active && !isPaused) {
                    target.remove();
                    activeTargets = activeTargets.filter(t => t !== target);
                    
                    if (type !== 'bomb') {
                        resetCombo();
                    }
                }
            }, lifetime);
            
            // –ú–ê–ì–ù–ò–¢
            if (boosters.magnet.active && !isPaused) {
                setTimeout(() => {
                    if (target.parentNode) {
                        handleTargetClick(target);
                    }
                }, 300);
            }
            
            // –ö–í–ê–ù–¢–û–í–ê–Ø –î–£–ü–õ–ò–ö–ê–¶–ò–Ø
            if (boosters.quantum.active && type !== 'bomb' && !isPaused) {
                setTimeout(() => {
                    createQuantumGhost(target);
                }, 500);
            }
        }
        
        // –ö–í–ê–ù–¢–û–í–´–ô –ü–†–ò–ó–†–ê–ö
        function createQuantumGhost(original) {
            if (!original.parentNode || isPaused) return;
            
            const ghost = original.cloneNode(true);
            ghost.classList.add('target-ghost');
            
            const rect = original.getBoundingClientRect();
            const fieldRect = field.getBoundingClientRect();
            
            const offsetX = (Math.random() - 0.5) * 100;
            const offsetY = (Math.random() - 0.5) * 100;
            
            ghost.style.left = Math.max(0, Math.min(fieldRect.width - 70, 
                parseFloat(original.style.left) + offsetX)) + 'px';
            ghost.style.top = Math.max(0, Math.min(fieldRect.height - 70, 
                parseFloat(original.style.top) + offsetY)) + 'px';
            
            field.appendChild(ghost);
            
            setTimeout(() => ghost.remove(), 1000);
        }
        
        // –û–ë–†–ê–ë–û–¢–ö–ê –ö–õ–ò–ö–ê
        function handleTargetClick(target) {
            if (isPaused) return;
            
            const type = target.dataset.type;
            const value = parseInt(target.dataset.value);
            const rect = target.getBoundingClientRect();
            const centerX = rect.left + rect.width / 2;
            const centerY = rect.top + rect.height / 2;
            
            if (type === 'bomb') {
                createExplosion(centerX, centerY, 'üí•BOOMüí•', '#FF0000');
                const earned = updateXSDC(value);
                resetCombo();
                showNotification('üí£ +' + earned + ' $XSDC');
                if (tg) tg.HapticFeedback.impactOccurred('heavy');
            } else if (type === 'quantum') {
                createExplosion(centerX, centerY, 'üåÄ‚àûüåÄ', '#9D00FF');
                const earned = updateXSDC(value);
                updateCombo();
                
                // –ö–≤–∞–Ω—Ç–æ–≤–∞—è –Ω–∞–≥—Ä–∞–¥–∞ - —Å–ø–∞–≤–Ω–∏–º 3 –ø—Ä–∏–∑—Ä–∞–∫–∞
                for (let i = 0; i < 3; i++) {
                    setTimeout(() => {
                        if (Math.random() > 0.5) spawnTarget();
                    }, i * 200);
                }
                
                if (tg) tg.HapticFeedback.impactOccurred('medium');
            } else {
                const earned = updateXSDC(value);
                createExplosion(centerX, centerY, '+' + earned, '#FFD700');
                updateCombo();
                
                if (tg) tg.HapticFeedback.impactOccurred('light');
            }
            
            // –í—Ä–µ–º–µ–Ω–Ω–∞—è —Ä—è–±—å
            createTimeRipple(centerX, centerY);
            
            // –ß–∞—Å—Ç–∏—Ü—ã
            createParticles(centerX, centerY, type);
            
            // –£–¥–∞–ª—è–µ–º
            target.remove();
            activeTargets = activeTargets.filter(t => t !== target);
        }
        
        // –í–ó–†–´–í
        function createExplosion(x, y, text, color) {
            if (isPaused) return;
            
            const exp = document.createElement('div');
            exp.className = 'explosion';
            exp.textContent = text;
            exp.style.left = x + 'px';
            exp.style.top = y + 'px';
            exp.style.color = color;
            exp.style.textShadow = `0 0 20px ${color}`;
            document.body.appendChild(exp);
            
            setTimeout(() => exp.remove(), 800);
        }
        
        // –ß–ê–°–¢–ò–¶–´
        function createParticles(x, y, type) {
            if (isPaused) return;
            
            const colors = {
                xsdc: ['#FFD700', '#FF6B00'],
                mega: ['#FF00FF', '#00FFFF'],
                bomb: ['#FF0000', '#FF6B00'],
                quantum: ['#9D00FF', '#00FFFF', '#FFD700']
            };
            
            const particleColors = colors[type] || colors.xsdc;
            const count = type === 'mega' ? 20 : type === 'quantum' ? 16 : 12;
            
            for (let i = 0; i < count; i++) {
                const p = document.createElement('div');
                p.className = 'particle';
                p.style.left = x + 'px';
                p.style.top = y + 'px';
                p.style.background = particleColors[Math.floor(Math.random() * particleColors.length)];
                
                const angle = (Math.PI * 2 * i) / count;
                const dist = 80 + Math.random() * 60;
                p.style.setProperty('--tx', Math.cos(angle) * dist + 'px');
                p.style.setProperty('--ty', Math.sin(angle) * dist + 'px');
                
                document.body.appendChild(p);
                setTimeout(() => p.remove(), 1000);
            }
        }
        
        // –£–í–ï–î–û–ú–õ–ï–ù–ò–ï
        function showNotification(text) {
            if (isPaused) return;
            
            notification.textContent = text;
            notification.className = 'show-notification';
            
            setTimeout(() => {
                notification.className = '';
            }, 1000);
        }
        
        // –ê–ö–¢–ò–í–ê–¶–ò–Ø –ë–£–°–¢–ï–†–ê
        function activateBooster(type) {
            if (isPaused) return;
            if (boosters[type].count <= 0 || boosters[type].active) return;
            
            boosters[type].count--;
            boosters[type].active = true;
            boosters[type].duration = type === 'x2' ? 10 : type === 'frenzy' ? 8 : type === 'magnet' ? 6 : 12;
            
            updateBoosterUI();
            addEffectBadge(type);
            
            if (type === 'frenzy') {
                showNotification('üå™Ô∏è CHAOS!');
                for (let i = 0; i < 25; i++) {
                    setTimeout(() => spawnTarget(), i * 150);
                }
            } else if (type === 'quantum') {
                showNotification('üåÄ TIME MANIPULATION!');
            } else if (type === 'x2') {
                showNotification('2Ô∏è‚É£‚úñÔ∏è XXX!');
            } else if (type === 'magnet') {
                showNotification('üß≤ MAGNETISM!');
            }
            
            if (tg) tg.HapticFeedback.notificationOccurred('success');
        }
        
        // UI –ë–£–°–¢–ï–†–û–í
        function updateBoosterUI() {
            document.querySelector('#boost-x2 .booster-count').textContent = boosters.x2.count;
            document.querySelector('#boost-frenzy .booster-count').textContent = boosters.frenzy.count;
            document.querySelector('#boost-magnet .booster-count').textContent = boosters.magnet.count;
            document.querySelector('#boost-quantum .booster-count').textContent = boosters.quantum.count;
            
            document.getElementById('boost-x2').classList.toggle('disabled', boosters.x2.count === 0);
            document.getElementById('boost-frenzy').classList.toggle('disabled', boosters.frenzy.count === 0);
            document.getElementById('boost-magnet').classList.toggle('disabled', boosters.magnet.count === 0);
            document.getElementById('boost-quantum').classList.toggle('disabled', boosters.quantum.count === 0);
        }
        
        // –ë–ï–ô–î–ñ –≠–§–§–ï–ö–¢–ê
        function addEffectBadge(type) {
            const badge = document.createElement('div');
            badge.className = 'effect-badge';
            badge.id = 'badge-' + type;
            
            const emojis = { x2: '2Ô∏è‚É£‚úñÔ∏è', frenzy: 'üå™Ô∏è', magnet: 'üß≤', quantum: 'üåÄ' };
            const colors = { x2: '#00FF00', frenzy: '#FF00FF', magnet: '#00FFFF', quantum: '#9D00FF' };
            
            badge.innerHTML = emojis[type] + ' <span id="timer-' + type + '">' + boosters[type].duration + '</span>—Å';
            badge.style.borderColor = colors[type];
            badge.style.color = colors[type];
            
            activeEffects.appendChild(badge);
        }
        
        // –¢–ê–ô–ú–ï–† –≠–§–§–ï–ö–¢–û–í
        const effectInterval = setInterval(() => {
            if (isPaused) return;
            
            for (const type in boosters) {
                if (boosters[type].active) {
                    boosters[type].duration--;
                    
                    const timer = document.getElementById('timer-' + type);
                    if (timer) {
                        timer.textContent = boosters[type].duration;
                    }
                    
                    if (boosters[type].duration <= 0) {
                        boosters[type].active = false;
                        const badge = document.getElementById('badge-' + type);
                        if (badge) badge.remove();
                        showNotification('‚è∞ EFFECT OVER');
                    }
                }
            }
        }, 1000);
        
        // –û–ë–†–ê–ë–û–¢–ß–ò–ö–ò –ë–£–°–¢–ï–†–û–í
        document.getElementById('boost-x2').addEventListener('click', () => activateBooster('x2'));
        document.getElementById('boost-frenzy').addEventListener('click', () => activateBooster('frenzy'));
        document.getElementById('boost-magnet').addEventListener('click', () => activateBooster('magnet'));
        document.getElementById('boost-quantum').addEventListener('click', () => activateBooster('quantum'));
        
        // –í–û–°–°–¢–ê–ù–û–í–õ–ï–ù–ò–ï –ë–£–°–¢–ï–†–û–í
        const boosterInterval = setInterval(() => {
            if (isPaused) return;
            
            for (const type in boosters) {
                if (boosters[type].count < 5 && Math.random() > 0.92) {
                    boosters[type].count++;
                    updateBoosterUI();
                    showNotification('‚ú® ' + { x2: '2X', frenzy: 'MADNESS', magnet: 'MAGNET', quantum: 'QUANT' }[type] + ' HEAL.');
                    if (tg) tg.HapticFeedback.impactOccurred('light');
                }
            }
        }, 5000);
        
        // –°–ü–ê–í–ù –¶–ï–õ–ï–ô
        function startSpawning() {
            const spawnInterval = setInterval(() => {
                if (isPaused || !gameStarted) return;
                
                const count = Math.floor(spawnSpeed) + (Math.random() > 0.7 ? 1 : 0);
                for (let i = 0; i < count; i++) {
                    setTimeout(() => spawnTarget(), i * 200);
                }
            }, 1000);
        }
        
        // –û–¢–°–õ–ï–ñ–ò–í–ê–ù–ò–ï –ö–ê–°–ê–ù–ò–ô
        let lastTouchX = 0;
        let lastTouchY = 0;
        
        document.addEventListener('touchmove', (e) => {
            if (isPaused) return;
            
            const touch = e.touches[0];
            createFingerTrail(touch.clientX, touch.clientY);
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –ø–æ–∑–∏—Ü–∏—é —Ñ–æ–Ω–∞
            const x = (touch.clientX / window.innerWidth) * 100;
            const y = (touch.clientY / window.innerHeight) * 100;
            quantumBg.style.setProperty('--mouse-x', x + '%');
            quantumBg.style.setProperty('--mouse-y', y + '%');
            
            lastTouchX = touch.clientX;
            lastTouchY = touch.clientY;
        }, { passive: true });
        
        // –ü–ê–£–ó–ê –ò –ú–ï–ù–Æ
        pauseButton.addEventListener('click', togglePause);
        resumeButton.addEventListener('click', togglePause);
        restartButton.addEventListener('click', restartGame);
        helpButton.addEventListener('click', showHelp);
        
        function togglePause() {
            isPaused = !isPaused;
            if (isPaused) {
                pauseMenu.classList.add('show');
                pauseButton.textContent = '‚ñ∂Ô∏è';
            } else {
                pauseMenu.classList.remove('show');
                pauseButton.textContent = '‚è∏Ô∏è';
            }
        }
        
        function restartGame() {
            if (!confirm('TRY AGAIN? All progress will drown.')) return;
            
            xsdc = 0;
            combo = 0;
            multiplier = 1;
            spawnSpeed = 1.0;
            emotionalIntensity = 0;
            
            // –°–±—Ä–æ—Å –±—É—Å—Ç–µ—Ä–æ–≤
            boosters = {
                x2: { count: 3, active: false, duration: 0 },
                frenzy: { count: 2, active: false, duration: 0 },
                magnet: { count: 2, active: false, duration: 0 },
                quantum: { count: 1, active: false, duration: 0 }
            };
            
            // –û—á–∏—Å—Ç–∫–∞ –ø–æ–ª—è
            activeTargets.forEach(target => target.remove());
            activeTargets = [];
            
            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ UI
            xsdcAmount.textContent = '0';
            comboValue.textContent = 'x1';
            multValue.textContent = 'x1';
            speedValue.textContent = '1.0';
            updateBoosterUI();
            
            // –û—á–∏—Å—Ç–∫–∞ —ç—Ñ—Ñ–µ–∫—Ç–æ–≤
            document.querySelectorAll('.effect-badge').forEach(badge => badge.remove());
            
            // –í—ã—Ö–æ–¥ –∏–∑ –ø–∞—É–∑—ã
            isPaused = false;
            pauseMenu.classList.remove('show');
            pauseButton.textContent = '‚è∏Ô∏è';
            
            showNotification('üîÑ NEW GAME');
        }
        
        function showHelp() {
            alert(`$XSDC QUANTUM CHAOS - RULES:

üíé Common target: +10 $XSDC
üí• Mega target: +50 $XSDC
üí£ Bombs: +100 $XSDC, but loose combo
üåÄ Quantum targets: +25 $XSDC and spawn a GHOST

‚ö° Combo: Increases when you hit targets
üî• Multiplier: Grows every 5 combo
üí® Resonance: Speeds up gameplay as combo rises

BOOSTERS:
2Ô∏è‚É£‚úñÔ∏è Double Up: Doubles rewards for 10s
üå™Ô∏è Mayhem: Spawns 25 targets instantly
üß≤ Magnetism: Auto-collects targets for 6s
üåÄ Quantum: Creates ghost targets for 12s

Use targets for $XSDC and combo!`);
        }
        
        // –°–û–•–†–ê–ù–ï–ù–ò–ï –ü–†–û–ì–†–ï–°–°–ê
        function saveProgress() {
            if (window.storage) {
                const data = {
                    xsdc: xsdc,
                    highScore: Math.max(xsdc, parseInt(localStorage.getItem('highScore') || '0')),
                    boosters: boosters
                };
                localStorage.setItem('xsdc_progress', JSON.stringify(data));
                localStorage.setItem('highScore', data.highScore.toString());
            }
        }
        
        // –ó–ê–ì–†–£–ó–ö–ê –ü–†–û–ì–†–ï–°–°–ê
        function loadProgress() {
            try {
                const saved = localStorage.getItem('xsdc_progress');
                if (saved) {
                    const data = JSON.parse(saved);
                    xsdc = data.xsdc || 0;
                    xsdcAmount.textContent = Math.floor(xsdc);
                    
                    if (data.boosters) {
                        for (const type in data.boosters) {
                            if (boosters[type]) {
                                boosters[type].count = data.boosters[type].count || boosters[type].count;
                            }
                        }
                        updateBoosterUI();
                    }
                }
            } catch (e) {
                console.log('–ù–æ–≤–∞—è –∏–≥—Ä–∞');
            }
        }
        
        // –ê–≤—Ç–æ—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∫–∞–∂–¥—ã–µ 10 —Å–µ–∫—É–Ω–¥
        setInterval(saveProgress, 10000);
        
        // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–∏ –∑–∞–∫—Ä—ã—Ç–∏–∏
        window.addEventListener('beforeunload', saveProgress);
        
        // –°–¢–ê–†–¢
        loadProgress();
        showNotification('üåÄ –ö–í–ê–ù–¢–û–í–´–ô –†–ï–ó–û–ù–ê–ù–° üåÄ');
        
        setTimeout(() => {
            showNotification('üíé –ù–ê–ß–ò–ù–ê–ô –§–ê–†–ú! üíé');
            gameStarted = true;
        }, 1500);
        
        startSpawning();
        
        // –ù–∞—á–∞–ª—å–Ω—ã–π —Å–ø–∞–≤–Ω
        for (let i = 0; i < 4; i++) {
            setTimeout(() => spawnTarget(), i * 400);
        }
        
        // –û—Ç–ø—Ä–∞–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö –≤ Telegram
        if (tg) {
            setInterval(() => {
                tg.sendData(JSON.stringify({
                    xsdc: Math.floor(xsdc),
                    combo: combo,
                    multiplier: multiplier
                }));
            }, 30000);
        }
    </script>
</body>
</html>
